-------------------------------------------
Batch: 0
-------------------------------------------
+----------+-------+---------+----------+-----------+--------+---------+
|invoice_no|country|timestamp|total_cost|total_items|is_order|is_return|
+----------+-------+---------+----------+-----------+--------+---------+
+----------+-------+---------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 1
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301156|United Kingdom|2022-07-13 05:46:47|10.200001 |12         |1       |0        |
|154132550301157|United Kingdom|2022-07-13 05:46:49|44.14     |14         |1       |0        |
|154132550301158|United Kingdom|2022-07-13 05:46:50|27.599998 |10         |1       |0        |
|154132550301159|United Kingdom|2022-07-13 05:46:51|1.45      |1          |1       |0        |
|154132550301160|United Kingdom|2022-07-13 05:46:52|17.39     |10         |1       |0        |
|154132550301161|United Kingdom|2022-07-13 05:46:55|15.0      |12         |1       |0        |
|154132550301162|United Kingdom|2022-07-13 05:46:58|25.58     |4          |1       |0        |
|154132550301163|United Kingdom|2022-07-13 05:46:59|16.4      |7          |1       |0        |
|154132550301164|Spain         |2022-07-13 05:47:01|70.45     |49         |1       |0        |
|154132550301165|United Kingdom|2022-07-13 05:47:09|20.85     |6          |1       |0        |
|154132550301166|United Kingdom|2022-07-13 05:47:10|118.65    |27         |1       |0        |
|154132550301167|United Kingdom|2022-07-13 05:47:12|28.01     |11         |1       |0        |
|154132550301168|United Kingdom|2022-07-13 05:47:15|46.699997 |10         |1       |0        |
|154132550301169|United Kingdom|2022-07-13 05:47:18|26.83     |32         |1       |0        |
|154132550301170|United Kingdom|2022-07-13 05:47:29|219.3     |258        |1       |0        |
|154132550301171|United Kingdom|2022-07-13 05:47:39|40.55     |241        |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 2
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301172|United Kingdom|2022-07-13 05:47:48|11.09     |7          |1       |0        |
|154132550301173|United Kingdom|2022-07-13 05:47:51|4.65      |1          |1       |0        |
|154132550301174|United Kingdom|2022-07-13 05:47:52|122.200005|42         |1       |0        |
|154132550301175|United Kingdom|2022-07-13 05:47:54|23.0      |11         |1       |0        |
|154132550301176|United Kingdom|2022-07-13 05:48:05|13.53     |7          |1       |0        |
|154132550301177|United Kingdom|2022-07-13 05:48:07|18.24     |96         |1       |0        |
|154132550301178|United Kingdom|2022-07-13 05:48:13|9.64      |14         |1       |0        |
|154132550301179|United Kingdom|2022-07-13 05:48:14|97.17     |37         |1       |0        |
|154132550301180|United Kingdom|2022-07-13 05:48:20|93.369995 |31         |1       |0        |
|154132550301181|United Kingdom|2022-07-13 05:48:30|43.27     |25         |1       |0        |
|154132550301182|United Kingdom|2022-07-13 05:48:39|38.3      |10         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 3
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301183|United Kingdom|2022-07-13 05:48:41|135.9     |80         |1       |0        |
|154132550301184|United Kingdom|2022-07-13 05:48:44|70.54     |18         |1       |0        |
|154132550301185|United Kingdom|2022-07-13 05:49:00|5.9       |2          |1       |0        |
|154132550301186|United Kingdom|2022-07-13 05:49:05|-81.99    |51         |0       |1        |
|154132550301187|United Kingdom|2022-07-13 05:49:13|-165.18001|121        |0       |1        |
|154132550301188|United Kingdom|2022-07-13 05:49:13|1.17      |3          |1       |0        |
|154132550301189|United Kingdom|2022-07-13 05:49:14|4.95      |1          |1       |0        |
|154132550301190|United Kingdom|2022-07-13 05:49:15|5.04      |12         |1       |0        |
|154132550301191|United Kingdom|2022-07-13 05:49:25|3.25      |5          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 4
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301192|United Kingdom|2022-07-13 05:49:42|22.1      |14         |1       |0        |
|154132550301193|United Kingdom|2022-07-13 05:49:45|33.36     |9          |1       |0        |
|154132550301194|United Kingdom|2022-07-13 05:50:00|26.26     |16         |1       |0        |
|154132550301195|United Kingdom|2022-07-13 05:50:01|46.19     |11         |1       |0        |
|154132550301196|United Kingdom|2022-07-13 05:50:03|157.39    |84         |1       |0        |
|154132550301197|United Kingdom|2022-07-13 05:50:06|6.58      |2          |1       |0        |
|154132550301198|United Kingdom|2022-07-13 05:50:10|27.04     |16         |1       |0        |
|154132550301199|United Kingdom|2022-07-13 05:50:12|16.51     |7          |1       |0        |
|154132550301200|United Kingdom|2022-07-13 05:50:29|70.840004 |16         |1       |0        |
|154132550301201|United Kingdom|2022-07-13 05:50:30|0.85      |1          |1       |0        |
|154132550301202|United Kingdom|2022-07-13 05:50:32|66.13     |52         |1       |0        |
|154132550301203|United Kingdom|2022-07-13 05:50:37|20.93     |12         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 5
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301204|United Kingdom|2022-07-13 05:50:42|8.35      |7          |1       |0        |
|154132550301205|United Kingdom|2022-07-13 05:50:49|19.22     |9          |1       |0        |
|154132550301206|United Kingdom|2022-07-13 05:50:50|116.299995|18         |1       |0        |
|154132550301207|United Kingdom|2022-07-13 05:50:50|46.56     |40         |1       |0        |
|154132550301208|United Kingdom|2022-07-13 05:50:51|419.25    |75         |1       |0        |
|154132550301209|United Kingdom|2022-07-13 05:50:52|31.7      |22         |1       |0        |
|154132550301210|France        |2022-07-13 05:50:55|103.61    |39         |1       |0        |
|154132550301211|United Kingdom|2022-07-13 05:50:56|39.64     |50         |1       |0        |
|154132550301212|United Kingdom|2022-07-13 05:51:11|168493.86 |81011      |1       |0        |
|154132550301213|United Kingdom|2022-07-13 05:51:12|137.9     |129        |1       |0        |
|154132550301214|United Kingdom|2022-07-13 05:51:16|13.52     |8          |1       |0        |
|154132550301215|United Kingdom|2022-07-13 05:51:23|26.68     |12         |1       |0        |
|154132550301216|United Kingdom|2022-07-13 05:51:25|46.989998 |31         |1       |0        |
|154132550301217|United Kingdom|2022-07-13 05:51:31|145.58    |52         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 6
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301218|United Kingdom|2022-07-13 05:52:03|1.45      |1          |1       |0        |
|154132550301219|United Kingdom|2022-07-13 05:52:10|13.6      |16         |1       |0        |
|154132550301220|United Kingdom|2022-07-13 05:52:24|9.22      |6          |1       |0        |
|154132550301221|United Kingdom|2022-07-13 05:52:24|20.8      |16         |1       |0        |
|154132550301222|United Kingdom|2022-07-13 05:52:27|44.64     |22         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 7
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301223|United Kingdom|2022-07-13 05:52:37|69.600006 |48         |1       |0        |
|154132550301224|United Kingdom|2022-07-13 05:52:37|36.82     |32         |1       |0        |
|154132550301225|United Kingdom|2022-07-13 05:52:42|80.76     |66         |1       |0        |
|154132550301226|United Kingdom|2022-07-13 05:52:47|30.92     |7          |1       |0        |
|154132550301227|Germany       |2022-07-13 05:52:47|81.29     |51         |1       |0        |
|154132550301228|United Kingdom|2022-07-13 05:52:50|83.399994 |12         |1       |0        |
|154132550301229|United Kingdom|2022-07-13 05:52:52|28.16     |10         |1       |0        |
|154132550301230|United Kingdom|2022-07-13 05:52:52|43.52     |14         |1       |0        |
|154132550301231|United Kingdom|2022-07-13 05:53:01|119.28    |24         |1       |0        |
|154132550301232|United Kingdom|2022-07-13 05:53:04|78.0      |24         |1       |0        |
|154132550301233|United Kingdom|2022-07-13 05:53:05|11.549999 |3          |1       |0        |
|154132550301234|United Kingdom|2022-07-13 05:53:13|22.5      |6          |1       |0        |
|154132550301235|United Kingdom|2022-07-13 05:53:17|43.789997 |11         |1       |0        |
|154132550301236|United Kingdom|2022-07-13 05:53:18|59.28     |20         |1       |0        |
|154132550301237|United Kingdom|2022-07-13 05:53:30|51.25     |61         |1       |0        |
|154132550301238|United Kingdom|2022-07-13 05:53:35|4.45      |3          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 8
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301239|United Kingdom|2022-07-13 05:53:43|16.5      |10         |1       |0        |
|154132550301240|United Kingdom|2022-07-13 05:54:08|40.2      |12         |1       |0        |
|154132550301241|United Kingdom|2022-07-13 05:54:15|5.95      |1          |1       |0        |
|154132550301242|United Kingdom|2022-07-13 05:54:23|21.18     |27         |1       |0        |
|154132550301243|United Kingdom|2022-07-13 05:54:28|39.84     |9          |1       |0        |
|154132550301244|United Kingdom|2022-07-13 05:54:29|12.5      |1          |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 9
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301245|France        |2022-07-13 05:54:38|74.32     |24         |1       |0        |
|154132550301246|United Kingdom|2022-07-13 05:54:42|2.1       |1          |1       |0        |
|154132550301247|EIRE          |2022-07-13 05:54:57|41.059998 |30         |1       |0        |
|154132550301248|United Kingdom|2022-07-13 05:55:02|218.14    |32         |1       |0        |
|154132550301249|United Kingdom|2022-07-13 05:55:21|2.55      |1          |1       |0        |
|154132550301250|United Kingdom|2022-07-13 05:55:27|22.68     |16         |1       |0        |
|154132550301251|Germany       |2022-07-13 05:55:29|135.44    |36         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 10
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301252|United Kingdom|2022-07-13 05:55:35|169.18999 |11         |1       |0        |
|154132550301253|United Kingdom|2022-07-13 05:55:41|8.84      |4          |1       |0        |
|154132550301254|United Kingdom|2022-07-13 05:55:45|40.56     |24         |1       |0        |
|154132550301255|France        |2022-07-13 05:55:46|27.67     |3          |1       |0        |
|154132550301256|United Kingdom|2022-07-13 05:56:01|4.16      |2          |1       |0        |
|154132550301257|United Kingdom|2022-07-13 05:56:07|99.25     |25         |1       |0        |
|154132550301258|United Kingdom|2022-07-13 05:56:15|10.95     |1          |1       |0        |
|154132550301259|United Kingdom|2022-07-13 05:56:17|54.89     |18         |1       |0        |
|154132550301260|United Kingdom|2022-07-13 05:56:18|153.31    |70         |1       |0        |
|154132550301261|United Kingdom|2022-07-13 05:56:22|10.95     |1          |1       |0        |
|154132550301262|United Kingdom|2022-07-13 05:56:25|-19.43    |7          |0       |1        |
|154132550301263|United Kingdom|2022-07-13 05:56:30|16.5      |10         |1       |0        |
|154132550301264|United Kingdom|2022-07-13 05:56:31|11.53     |25         |1       |0        |
|154132550301265|United Kingdom|2022-07-13 05:56:31|1864.2    |156        |1       |0        |
|154132550301266|United Kingdom|2022-07-13 05:56:31|171.42    |59         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 11
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301267|United Kingdom|2022-07-13 05:56:32|26.4      |16         |1       |0        |
|154132550301268|United Kingdom|2022-07-13 05:56:37|24.3      |21         |1       |0        |
|154132550301269|United Kingdom|2022-07-13 05:56:43|10.41     |2          |1       |0        |
|154132550301270|United Kingdom|2022-07-13 05:56:49|48.37     |38         |1       |0        |
|154132550301271|United Kingdom|2022-07-13 05:56:51|1.45      |1          |1       |0        |
|154132550301272|United Kingdom|2022-07-13 05:56:57|14.4      |7          |1       |0        |
|154132550301273|France        |2022-07-13 05:56:59|-173.23   |49         |0       |1        |
|154132550301274|United Kingdom|2022-07-13 05:56:59|37.75     |21         |1       |0        |
|154132550301275|United Kingdom|2022-07-13 05:57:04|265.4     |88         |1       |0        |
|154132550301276|United Kingdom|2022-07-13 05:57:10|79.68     |48         |1       |0        |
|154132550301277|United Kingdom|2022-07-13 05:57:13|336.4     |61         |1       |0        |
|154132550301278|United Kingdom|2022-07-13 05:57:16|10.2      |4          |1       |0        |
|154132550301279|United Kingdom|2022-07-13 05:57:30|24.9      |18         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+

-------------------------------------------
Batch: 12
-------------------------------------------
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|invoice_no     |country       |timestamp          |total_cost|total_items|is_order|is_return|
+---------------+--------------+-------------------+----------+-----------+--------+---------+
|154132550301280|United Kingdom|2022-07-13 05:57:33|16.5      |10         |1       |0        |
|154132550301281|United Kingdom|2022-07-13 05:58:16|58.86     |14         |1       |0        |
|154132550301282|United Kingdom|2022-07-13 05:58:16|12.75     |1          |1       |0        |
|154132550301283|United Kingdom|2022-07-13 05:58:26|-9.05     |5          |0       |1        |
|154132550301284|United Kingdom|2022-07-13 05:58:28|11.74     |15         |1       |0        |
+---------------+--------------+-------------------+----------+-----------+--------+---------+


Traceback (most recent call last):
  File "/home/hadoop/scripts/spark-streaming.py", line 146, in <module>
    time_and_country_based_kpi_df_output.awaitTermination() 
  File "/usr/lib/spark/python/lib/pyspark.zip/pyspark/sql/streaming.py", line 103, in awaitTermination
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1255, in __call__
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 985, in send_command
  File "/usr/lib/spark/python/lib/py4j-0.10.7-src.zip/py4j/java_gateway.py", line 1152, in send_command
  File "/usr/lib64/python3.7/socket.py", line 589, in readinto
    return self._sock.recv_into(b)
  File "/usr/lib/spark/python/lib/pyspark.zip/pyspark/context.py", line 278, in signal_handler
KeyboardInterrupt
